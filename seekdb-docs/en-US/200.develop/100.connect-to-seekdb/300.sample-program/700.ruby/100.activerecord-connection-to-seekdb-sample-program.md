---
slug: /activerecord-connection-to-seekdb-sample-program
---

# ActiveRecord connection to seekdb sample program

This topic describes how to build an application using ActiveRecord and seekdb to perform basic operations such as creating tables, inserting data, and querying data.

## Prerequisites

* You have installed Ruby and RubyGems.
* You have installed seekdb.

## Procedure

1. Check the versions of Ruby and RubyGems.
2. Install the required gems.
3. Obtain the seekdb connection information.
4. Create and configure a Rails application.
5. Run the sample program.

### Step 1: Check the versions of Ruby and RubyGems

Open the terminal and run the following command to check the versions of Ruby and RubyGems:

```shell
ruby -v
gem -v
```

### Step 2: Install the required gems

1. Install the system dependencies (for example, Ubuntu):

    ```shell
    sudo apt-get install ruby-dev mysql-client libmysqlclient-dev
    ```

2. If you use RVM (Ruby Version Manager):

    ```shell
    rvm requirements
    ```

3. If you use rbenv:

    ```shell
    rbenv install -l  # View available versions
    rbenv install x.x.x  # Install a specific version
    rbenv global x.x.x  # Set the global version
    ```

4. Use `gem` to install ActiveRecord and mysql2:

    ```shell
    gem install activerecord mysql2
    ```

### Step 3: Obtain the seekdb connection information

Contact the seekdb deployment personnel or administrator to obtain the database connection string.

```shell
mysql -h$host -P$port -u$user_name -p$password -D$database_name
```

**Parameter description:**

* `$host`: the IP address for connecting to seekdb.
* `$port`: the port for connecting to seekdb.
* `$database_name`: the name of the database to access.
* `$user_name`: the account for connecting to seekdb.
* `$password`: the password for the account.

### Step 4: Create and configure a Rails application

1. Create a new Rails application:

    ```shell
    rails new activerecord_seekdb -d mysql
    ```

2. Configure the database connection information:

    Add the following configuration to `config/database.yml`:

    ```yaml
    development:
      adapter: mysql2
      encoding: utf8mb4
      database: your_database
      username: your_username
      password: your_password
      host: your_host
      port: your_port
    ```

3. Create a sample model:

    ```ruby
    # app/models/user.rb
    class User < ActiveRecord::Base
      validates :name, presence: true
    end
    ```

### Step 5: Run the sample program

1. Create a database table:

    ```ruby
    # db/migrate/20230520_create_users.rb
    class CreateUsers < ActiveRecord::Migration[6.1]
      def change
        create_table :users do |t|
          t.string :name
          t.timestamps
        end
      end
    end
    ```

2. Run the migration:

    ```shell
    rails db:migrate
    ```

3. Test in the Rails console:

    ```shell
    rails c
    ```

    ```ruby
    # Create a record
    user = User.create(name: "John Doe")
    ```

    ```ruby
    # Query records
    users = User.all
    ```

## Common issues

1. **Connection error**: If you cannot connect to the database, check the following:
   * Whether the database address and port are correct
   * Whether the username and password are correct
   * Whether the network connection is normal

2. **Permission error**: If you encounter a permission-related error, make sure the user has sufficient permissions to perform the required operations.

3. **SQL syntax error**: If the SQL statement has a syntax error, check whether the SQL statement syntax is correct.

## Performance optimization suggestions

1. Use ActiveRecord's batch operation methods (such as `insert_all`)
2. Use preloading (preload) to avoid N+1 query issues
3. Use caching appropriately
4. Optimize database indexes