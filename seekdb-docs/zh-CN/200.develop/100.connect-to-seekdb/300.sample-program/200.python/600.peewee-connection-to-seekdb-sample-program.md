---

slug: /peewee-connection-to-seekdb-sample-program
---

# peewee 连接 seekdb 示例程序

本文将介绍如何使用 peewee 连接 seekdb，实现基本的数据库操作，包括创建表、插入数据、更新数据和查询数据等。

## 前提条件

* 您已安装 Python 3.x 和 pip。
* 您已安装 seekdb。

## 操作步骤

1. 获取 seekdb 连接串。
2. 安装 peewee 和 MySQL 客户端库。
3. 编写 `test.py` 文件，填入数据库连接信息。
4. 运行 `test.py` 文件。

### 步骤一：获取 seekdb 连接串

联系 seekdb 部署人员或者管理员获取相应的数据库连接串。

```shell
mysql -h$host -P$port -u$user_name -p$password -D$database_name
```

**参数说明：**

* `$host`：提供 seekdb 的连接 IP。应该被实际的 IP 替换，也可以使用本地 IP 及 127.0.0.1。
* `$port`：提供 seekdb 接端口。应该被实际的端口替换，默认是 2881，在部署 seekdb 时可自定义。
* `$database_name`：需要访问的数据库名称。
* `$user_name`：提供连接账户。格式：`用户名` 。
* `$password`：提供账户密码。

更多连接串的信息，请参见 [通过 MySQL 客户端连接 seekdb](../../200.use-client-connect-seekdb/100.connect-to-seekdb-by-using-a-mysql-client.md)。

**示例如下：**

```shell
mysql -hxxx.xxx.xxx.xxx -P2881 -uroot -p****** -Dtest
```

### 步骤二：安装 peewee 和 MySQL 客户端库

peewee 是一个轻量级的 Python ORM（对象关系映射）库，它提供了简单而强大的 API，可以简化数据库操作。peewee 支持多种数据库后端，包括 MySQL、PostgreSQL、SQLite 等。

打开命令提示符或 PowerShell 终端，运行以下命令，安装 peewee 和 MySQL 客户端库。

```shell
pip install peewee pymysql
```

安装完成后，可以通过以下命令验证安装是否成功：

```shell
pip list | grep peewee
```

:::info

peewee 是一个轻量级的 ORM 库，它提供了简单而强大的 API，可以简化数据库操作。peewee 支持多种数据库后端，包括 MySQL、PostgreSQL 和 SQLite 等。

:::

### 步骤三：编写 test.py 文件，填入数据库连接信息

根据 **步骤一：获取 seekdb 连接串** 中的信息编写 `test.py` 文件，填入数据库连接信息。

1. 创建一个名为 `test.py` 的文件。

2. 在 `test.py` 文件中填入以下内容，并根据实际情况修改数据库连接信息。

   **`test.py` 文件内容示例如下：**

   ```python
   from peewee import *

   # 数据库连接信息
   DB_USER = 'root'
   DB_PASSWORD = '******'
   DB_HOST = 'xxx.xxx.xxx.xxx'
   DB_PORT = 2881
   DB_NAME = 'test'

   # 创建数据库连接
   db = MySQLDatabase(
       DB_NAME,
       user=DB_USER,
       password=DB_PASSWORD,
       host=DB_HOST,
       port=DB_PORT
   )

   # 定义模型
   class User(Model):
       name = CharField(max_length=50)
       age = IntegerField()

       class Meta:
           database = db
           table_name = 'users'

       def __str__(self):
           return f"{self.name} ({self.age})"

   # 连接数据库
   db.connect()

   # 创建表
   db.create_tables([User])

   # 插入数据
   User.create(name='John', age=20)
   User.create(name='Lucy', age=25)
   User.create(name='Tom', age=30)

   # 更新数据
   user = User.get(User.name == 'Lucy')
   user.age = 26
   user.save()

   # 查询数据
   users = User.select()
   for user in users:
       print(user)

   # 关闭数据库连接
   db.close()
   ```

### 步骤四：运行 test.py 文件

打开命令提示符或 PowerShell 终端，运行 `test.py` 文件，查询数据并输出结果。

1. 进入到 `test.py` 文件所在的目录。

    **示例如下：**

    ```shell
    cd D:\demo\demo
    ```

2. 运行 `test.py` 文件。

    **示例如下：**

    ```shell
    python test.py
    ```

    返回结果如下：

    ```shell
    John (20)
    Lucy (26)
    Tom (30)
    ```

## 错误处理

在使用 peewee 连接 seekdb 时，可能会遇到各种错误。以下是一些常见的错误及其处理方法：

1. **连接错误**：如果无法连接到数据库，请检查连接参数是否正确，包括主机名、端口、用户名、密码和数据库名。

2. **权限错误**：如果遇到权限相关的错误，请确保用户拥有足够的权限来执行所需的操作。

3. **SQL 语法错误**：如果 SQL 语句有语法错误，请检查 SQL 语句的语法是否正确。

4. **数据类型错误**：如果插入的数据类型与表定义不匹配，请确保插入的数据类型正确。

在 peewee 中，我们可以使用 `try-except` 语句来捕获和处理这些错误，确保程序在遇到错误时能够优雅地处理，而不是直接崩溃。同时，我们可以使用 Python 的 `logging` 模块记录错误信息，方便调试和问题排查。

## 相关文档

* 更多连接 seekdb 的信息，请参见 [连接方式概述](../../100.connection-methods-overview.md)。